<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
	
	<!-- Search Form -->
	<form id="searchForm" onsubmit="return false;">
	    <label for="searchUsername">Username:</label>
	    <input type="text" id="searchUsername" name="username" placeholder="Search by Username" oninput="searchCustomers()">
	    
	    <label for="searchID">User ID:</label>
	    <input type="text" id="searchID" name="userID" placeholder="Search by User ID" oninput="searchCustomers()">
	</form>
	<!-- Body  -->
    <div class="container1">
         <h1>Customer List</h1>
        <table id="customerTable">
            <thead>
                <tr>
                	<th>ID Manager</th>
                    <th>ID Shipper</th>
                    <th>Picture</th>
                    <th>Name</th>
                    <th>CCCD</th>
                    <th>Phone</th>
                    <th>Address</th>
                    <th>Gender</th>
                    <th>Birth</th>
                    <th>City</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="shipper : ${shippers}">
                	<td th:text="${shipper.manager?.IDManager}"></td>
                    <td th:text="${shipper.IDShipper}"></td>
                    <td>
					    <img height="150" width="200"
					         th:if="${shipper.picture != null and shipper.picture.startsWith('http')}"
					         th:src="${shipper.picture}"  />
					
					    <img height="150" width="200"
					         th:if="${shipper.picture != null and !shipper.picture?.startsWith('http')}"
					         th:src="@{/image/{fname}(fname=${shipper.picture})}"/>
					    <img height="150" width="200"
					         th:if="${shipper.picture == null}"
					         th:src="@{/image/{fname}(fname='avatar.jpg')}"/>
					</td>
                    <td th:text="${shipper.name}"></td>
                    <td th:text="${shipper.cccd}"></td>
                    <td th:text="${shipper.phone}"></td>
                    <td th:text="${shipper.address}"></td>
                    <td th:text="${shipper.gender}"></td>
                    <td th:text="${shipper.birth}"></td>
                    <td th:text="${shipper.city}"></td>
                    <td>
                        <a th:href="@{/manager/shipper/add/{id}(id=${shipper.IDShipper})}">Add</a>
                        <a th:href="@{/manager/shipper/edit/{id}(id=${shipper.IDShipper})}">Edit</a>
                        <a th:href="@{/manager/shipper/delete/{id}(id=${shipper.IDShipper})}">Delete</a>
                    </td>
                </tr>
            </tbody>
        </table>
        
    </div>
    
<script>
    // Function to search and filter table rows
    function searchCustomers() {
        // Get the values from the input fields
        var username = document.getElementById('searchUsername').value.toLowerCase();
        var userID = document.getElementById('searchID').value.toLowerCase();

        // Get all rows in the table
        var rows = document.getElementById('customerTable').getElementsByTagName('tr');
        
        // Loop through all table rows and hide those that do not match the search criteria
        for (var i = 1; i < rows.length; i++) {
            var cells = rows[i].getElementsByTagName('td');
            
            // Get values from the relevant columns (assuming username is in column 3, ID User in column 2)
            var usernameCell = cells[2].textContent.toLowerCase(); // Username column
            var userIDCell = cells[1].textContent.toLowerCase(); // ID User column
            
            // Check if the current row matches the search filters
            var matchesUsername = usernameCell.includes(username);
            var matchesUserID = userIDCell.includes(userID);

            // Show/hide row based on whether it matches the search input
            if (matchesUsername && matchesUserID) {
                rows[i].style.display = ''; // Show the row
            } else {
                rows[i].style.display = 'none'; // Hide the row
            }
        }
    }
</script>
    
</html>